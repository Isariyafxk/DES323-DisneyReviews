<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>California Sentiment Pie Chart</title>
    <!-- Add D3.js CDN link -->
    <script src="https://d3js.org/d3.v5.min.js"></script>
</head>
<body>

<!-- Add a container for the pie chart -->
<div id="sentimentPieChart"></div>

<script>
// Retrieve sentiment percentages from the server-side context

// Data for the pie chart
const data = [
    { label: 'Positive', value: positivePercentage },
    { label: 'Neutral', value: neutralPercentage },
    { label: 'Negative', value: negativePercentage }
];

// Set up dimensions for the pie chart
const width = 300;
const height = 300;
const radius = Math.min(width, height) / 2;

// Create an SVG element and append it to the container
const svg = d3.select('#sentimentPieChart')
    .append('svg')
    .attr('width', width)
    .attr('height', height)
    .append('g')
    .attr('transform', 'translate(' + width / 2 + ',' + height / 2 + ')');

// Create a pie chart
const pie = d3.pie().value(d => d.value);
const arc = d3.arc().outerRadius(radius).innerRadius(0);

// Add the arcs to the SVG
svg.selectAll('path')
    .data(pie(data))
    .enter()
    .append('path')
    .attr('d', arc)
    .attr('fill', (d, i) => ['#4CAF50', '#FFC107', '#FF5722'][i]) // Colors for positive, neutral, and negative
    .attr('stroke', 'white')
    .style('stroke-width', '2px');

// Add labels
svg.selectAll('text')
    .data(pie(data))
    .enter()
    .append('text')
    .attr('transform', d => 'translate(' + arc.centroid(d) + ')')
    .attr('text-anchor', 'middle')
    .text(d => d.data.label);
</script>

</body>
</html>
